:: loading settings :: url = jar:file:/C:/Spark/spark-3.2.2-bin-hadoop3.2/jars/ivy-2.5.0.jar!/org/apache/ivy/core/settings/ivysettings.xml
Ivy Default Cache set to: C:\Users\User\.ivy2\cache
The jars for the packages stored in: C:\Users\User\.ivy2\jars
org.mongodb.spark#mongo-spark-connector added as a dependency
:: resolving dependencies :: org.apache.spark#spark-submit-parent-28fd9bbe-71fe-447a-8661-bbbed19c6d76;1.0
	confs: [default]
	found org.mongodb.spark#mongo-spark-connector;10.0.5 in central
	found org.mongodb#mongodb-driver-sync;4.5.1 in central
	[4.5.1] org.mongodb#mongodb-driver-sync;[4.5.0,4.5.99)
	found org.mongodb#bson;4.5.1 in central
	found org.mongodb#mongodb-driver-core;4.5.1 in central
:: resolution report :: resolve 1992ms :: artifacts dl 17ms
	:: modules in use:
	org.mongodb#bson;4.5.1 from central in [default]
	org.mongodb#mongodb-driver-core;4.5.1 from central in [default]
	org.mongodb#mongodb-driver-sync;4.5.1 from central in [default]
	org.mongodb.spark#mongo-spark-connector;10.0.5 from central in [default]
	---------------------------------------------------------------------
	|                  |            modules            ||   artifacts   |
	|       conf       | number| search|dwnlded|evicted|| number|dwnlded|
	---------------------------------------------------------------------
	|      default     |   4   |   1   |   0   |   0   ||   4   |   0   |
	---------------------------------------------------------------------
:: retrieving :: org.apache.spark#spark-submit-parent-28fd9bbe-71fe-447a-8661-bbbed19c6d76
	confs: [default]
	0 artifacts copied, 4 already retrieved (0kB/14ms)
Using Spark's default log4j profile: org/apache/spark/log4j-defaults.properties
Setting default log level to "WARN".
To adjust logging level use sc.setLogLevel(newLevel). For SparkR, use setLogLevel(newLevel).
Pipeline initialized.
[Stage 0:>                                                          (0 + 1) / 1]                                                                                Data summary:
[Stage 1:===================>                                       (1 + 1) / 3][Stage 1:=======================================>                   (2 + 1) / 3][Stage 3:>                                                          (0 + 1) / 1]                                                                                +-------+-----------------+--------------------+------------+
|summary|          cluster|          product_id|product_name|
+-------+-----------------+--------------------+------------+
|  count|           100000|              100000|       99711|
|   mean|          2.44147|5.632470952534317E12|        19.0|
| stddev|1.495946729554975|1.722844228750424...|        null|
|    min|                0|                 000|            |
|    25%|                1|     2.4739160293E10|        19.0|
|    50%|                2|     4.1331051002E10|        19.0|
|    75%|                4|     7.0177029661E10|        19.0|
|    max|                4|       0077507005067|        ??|
+-------+-----------------+--------------------+------------+

Cluster distribution:
+-------+-----+
|cluster|count|
+-------+-----+
|      2|18586|
|      4|44874|
|      1|27452|
|      0| 9079|
|      3|    9|
+-------+-----+

[Stage 7:===================>                                       (1 + 1) / 3][Stage 7:=======================================>                   (2 + 1) / 3]23/01/12 00:59:03 WARN ProcfsMetricsGetter: Exception when trying to compute pagesize, as a result reporting of ProcessTree metrics is stopped
                                                                                [Stage 10:>                                                         (0 + 1) / 3][Stage 10:===================>                                      (1 + 1) / 3][Stage 10:======================================>                   (2 + 1) / 3][Stage 12:>                                                         (0 + 1) / 1]                                                                                [Stage 14:===================>                                      (1 + 1) / 3][Stage 14:======================================>                   (2 + 1) / 3][Stage 16:>                                                         (0 + 1) / 1]                                                                                Silhouette score: 0.14336945923529684
Pipeline initialized successfully.
[Stage 17:===================>                                      (1 + 1) / 3][Stage 17:======================================>                   (2 + 1) / 3][Stage 18:===================>                                      (1 + 1) / 3][Stage 18:======================================>                   (2 + 1) / 3][Stage 20:>                                                         (0 + 1) / 1]                                                                                [Stage 22:>                                                         (0 + 1) / 1]23/01/12 00:59:20 WARN InstanceBuilder$NativeBLAS: Failed to load implementation from:dev.ludovic.netlib.blas.JNIBLAS
23/01/12 00:59:20 WARN InstanceBuilder$NativeBLAS: Failed to load implementation from:dev.ludovic.netlib.blas.ForeignLinkerBLAS
                                                                                23/01/12 00:59:20 WARN BLAS: Failed to load implementation from: com.github.fommil.netlib.NativeSystemBLAS
23/01/12 00:59:20 WARN BLAS: Failed to load implementation from: com.github.fommil.netlib.NativeRefBLAS
[Stage 265:===================>                                     (1 + 1) / 3][Stage 265:======================================>                  (2 + 1) / 3][Stage 266:===================>                                     (1 + 1) / 3][Stage 266:======================================>                  (2 + 1) / 3][Stage 267:===================>                                     (1 + 1) / 3][Stage 267:======================================>                  (2 + 1) / 3][Stage 269:>                                                        (0 + 1) / 1]                                                                                [Stage 270:===================>                                     (1 + 1) / 3][Stage 270:======================================>                  (2 + 1) / 3]23/01/12 00:59:44 WARN Instrumentation: [cc362cbe] regParam is zero, which might cause numerical instability and overfitting.
[Stage 272:>                                                        (0 + 1) / 1]                                                                                23/01/12 00:59:45 WARN InstanceBuilder$NativeLAPACK: Failed to load implementation from:dev.ludovic.netlib.lapack.JNILAPACK
23/01/12 00:59:45 WARN Instrumentation: [cc362cbe] Cholesky solver failed due to singular covariance matrix. Retrying with Quasi-Newton solver.
[Stage 273:===================>                                     (1 + 1) / 3][Stage 273:======================================>                  (2 + 1) / 3][Stage 275:>                                                        (0 + 1) / 1]                                                                                Pipeline fitted successfully.
Train metrics:
[Stage 277:>                                                        (0 + 1) / 1]Classification accuracy: 1.00
Weighted precision: 1.00
Weighted recall: 1.00
                                                                                Regression MSE: 0.77
Regression MAE: 0.69
Explained variance: 1.47
Test metrics:
[Stage 279:===================>                                     (1 + 1) / 3][Stage 279:======================================>                  (2 + 1) / 3][Stage 281:>                                                        (0 + 1) / 1]                                                                                Classification accuracy: 0.9976118214836559
[Stage 283:===================>                                     (1 + 1) / 3][Stage 283:======================================>                  (2 + 1) / 3][Stage 285:>                                                        (0 + 1) / 1]                                                                                Weighted precision: 0.9976781959170591
[Stage 287:===================>                                     (1 + 1) / 3][Stage 287:======================================>                  (2 + 1) / 3][Stage 289:>                                                        (0 + 1) / 1]Weighted recall: 0.997611821483656
                                                                                [Stage 291:===================>                                     (1 + 1) / 3][Stage 291:======================================>                  (2 + 1) / 3][Stage 293:>                                                        (0 + 1) / 1]Regression MSE: 0.7612645936879521
                                                                                [Stage 294:===================>                                     (1 + 1) / 3][Stage 294:======================================>                  (2 + 1) / 3][Stage 296:>                                                        (0 + 1) / 1]Regression MAE: 0.6882612159152771
                                                                                